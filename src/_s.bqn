
tâ†"ğ•¨ğ•©"
uâ†"wx"

eâ†@+27

châ†âŸ¨âŸ©
psâ†0

asnâ€¿delâ€¿movâ€¿cmdâ€¿clrâ†â†•5 # effect flags

# TODO up and down for history

Mapâ†{
  ğ•¨ğ•Šğ•©: âŠ‘"\"=Â¯1â†‘ğ•¨ ? âŸ¨(Â¯1â†“ğ•¨)âˆ¾t/Ëœğ•©=u, asnâŸ©
; ğ•¨ğ•Šğ•©: ğ•©=@+10    ? âŸ¨âŸ¨âŸ©,            cmdâŸ© # TODO execute command
; ğ•¨ğ•Šğ•©: ğ•©=@+127   ? âŸ¨Â¯1â†“ğ•¨,          delâŸ© # TODO delete current position first
; ğ•¨ğ•Šğ•©: ğ•©=@+21    ? âŸ¨âŸ¨âŸ©,            clrâŸ©
; ğ•¨ğ•Šğ•©: ğ•©=e       ? âŸ¨ğ•¨,             movâŸ©
; ğ•¨ğ•Šğ•©: 0=â‰ ğ•¨      ? âŸ¨ğ•¨âˆ¾ğ•©,           asnâŸ©
; ğ•¨ğ•Šğ•©:             
    âŸ¨âˆ¾(âˆ¾âŸœğ•©)Â¨âŒ¾(1âŠ¸â†‘) ğ•¨âŠ”Ëœpsâ‰¤â†•â‰ ğ•¨, asnâŸ© # insert character in position ps
}

â€¢term.RawMode 1
{ğ•Š:
  âŸ¨ch0,effâŸ©â†ch  Map â€¢term.CharB@
  { ğ•Šğ•©:ğ•©=asn ? ps 1âŠ¸+â†© â‹„châ†©ch0
  ; ğ•Šğ•©:ğ•©=clr ? ps â†©0   â‹„châ†©ch0
  ; ğ•Šğ•©:ğ•©=mov ? {"[D":psâ†©ps-1;"[C": psâ†©ps+1;Â·:@}âŸ¨â€¢term.CharB@,â€¢term.CharB@âŸ© 
  ; ğ•Šğ•©:@
  } eff

  â€¢term.OutRaw eâˆ¾"[2K"âˆ¾eâˆ¾"[0G" # clear line and set to start of line
  â€¢term.OutRaw â€¢ToUTF8 ch
  â€¢term.OutRaw eâˆ¾"["âˆ¾(â€¢Fmt ps+1)âˆ¾"G"
  â€¢term.Flush@
}â€¢_while_ 1 @

